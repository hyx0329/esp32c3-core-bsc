# `esp32c3-core-bsc`

> Board support crate for the ESP32C3-CORE board

As far as I know, this board is designed and distributed by LuatOS Team.

This is my first attempt to create a bsc.

## Getting started

### Installing dependencies

- Use Rust `1.67.0-nightly (b833ad56f 2022-11-18)` (tested) or later
    ```bash
    rustup install nightly
    rustup component add rust-src --toolchain nightly
    ```
- Install a recent Clang compiler, OS-specific
- Install Python3(3.7 or later), OS-specific
- Install Cargo sub-commands
    ```bash
    cargo install ldproxy
    cargo install espflash
    cargo install espmonitor
    ```

### Building and Flashing Using the Serial Port

To run the `display` example, connect the USB port(the one to the on-board CH343) and run the following command:

```bash
cargo run --example=display --features="lcd_hat"
```

You might be asked which serial port to use, please follow the direction and select the right port.

*Note: the build of `esp-idf-sys` will clone a big repository, so keep a good internet connection when build for the first time.*

### Using OpenOCD for Flashing and Debugging

Prepare a USB breakout board(or whatever suitable), connect the `IO18` to USB's `D-` and `IO19` to `D+`, then connect
it to your computer(don't forget the power). After installing a suitable openocd release(e.g. `openocd-esp32` on ArchLinux),
run the following command to start the server.

```bash
# the executables' names vary, the actual one may be openocd, or openocd-esp32openocd, or others.
# this command works on ArchLinux, the configuration for openocd is not bundled with this crate
openocd -f board/esp32c3-builtin.cfg
```

Then you can start a GDB console to flash the firmware manually. Further more, you can tweak the configuration in
`.cargo/config.toml` to meet your own need.

## Notes

- The code for display(example) is adapted from the example provided by `embedded_graphics`.
- The code for WiFi(`src/wifi.rs`) is **COPIED** from [espressif-training](https://ferrous-systems/espressif-trainings/).
- The code for LED and LCD control takes [longan-nano](https://github.com/riscv-rust/longan-nano/) as a reference.
- This crate is based on a template generated by [esp-idf-template](https://github.com/esp-rs/esp-idf-template/) and currently requires STD to work. Read more info there.

## Todos

- [ ] write code for the D-PAD on the LCD-HAT
- [ ] add a ferris example

